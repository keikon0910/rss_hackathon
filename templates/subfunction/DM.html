<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>メッセージ | SNS</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans JP', ui-sans-serif, system-ui, -apple-system,
            BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans",
            sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; }
  </style>
</head>
<body class="bg-white text-black antialiased">

  <!-- Header -->
  <header class="sticky top-0 z-10 bg-white/95 backdrop-blur border-b border-black/10">
    <div class="max-w-2xl mx-auto px-4 py-3 flex items-center gap-3">
      <button onclick="history.back()" class="p-2 rounded-full hover:bg-black/5" aria-label="戻る">
        <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path d="M15.75 19.5 8.25 12l7.5-7.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <h1 class="text-base font-semibold">メッセージ</h1>
    </div>
  </header>

  <!-- List -->
  <main class="max-w-2xl mx-auto px-3 sm:px-4 pb-6">
    <ul id="threadList" class="divide-y divide-black/10"></ul>

    <!-- 空状態 -->
    <div id="empty" class="hidden">
      <div class="mt-10 rounded-2xl border border-black/10 bg-gray-50 p-8 text-center">
        <div class="text-lg font-semibold mb-1">会話はまだありません</div>
        <p class="text-sm text-black/60">新しいメッセージが届くとここに表示されます</p>
      </div>
    </div>
  </main>

  <script>
    // ===== ダミーデータ（API接続時は置き換え） =====
    const threads = [
      { id: 1, name: 'okamoto_151', avatar: '',  lastAt: '12:30',snippet: 'また連絡します〜' },
      { id: 2, name: 'nagoyagrampus', avatar: '', lastAt: '10:00', snippet: '試合のチケット情報です' },
      { id: 3, name: 'line_coupon',   avatar: '', lastAt: '昨日',  snippet: '本日スタート！お得な…' },
      { id: 4, name: 'zozotown',      avatar: '', lastAt: '昨日', snippet: 'セール開催中！' },
      { id: 5, name: 'miho',          avatar: '', lastAt: '3日前',snippet: '写真送ったよ📷' },
    ];

    // ===== ユーティリティ =====
    function avatarElm(name, url) {
      // 画像URLがあれば <img>、なければ頭文字でプレースホルダ
      if (url) {
        return `
          <img src="${url}" alt="${name}" class="w-12 h-12 rounded-full object-cover border border-black/10">
        `;
      }
      const init = (name || 'U')[0].toUpperCase();
      return `
        <div class="w-12 h-12 rounded-full grid place-items-center bg-black/5 text-black/70 border border-black/10">
          <span class="text-sm font-medium">${init}</span>
        </div>
      `;
    }

    function unreadBadge(n) {
      if (!n || n <= 0) return '';
      const text = n > 99 ? '99+' : String(n);
      return `
        <div class="shrink-0 w-7 h-7 rounded-full bg-blue-600 text-white grid place-items-center text-xs font-semibold">
          ${text}
        </div>
      `;
    }

    // ===== レンダリング =====
    const list = document.getElementById('threadList');
    const empty = document.getElementById('empty');

    function render() {
      if (!threads.length) {
        empty.classList.remove('hidden');
        return;
      }
      empty.classList.add('hidden');
      list.innerHTML = '';

      threads.forEach(t => {
        const li = document.createElement('li');
        li.className = 'py-3 sm:py-3.5';
        li.innerHTML = `
          <a href="#" class="flex items-center gap-3 sm:gap-4">
            <!-- 左：アイコン -->
            ${avatarElm(t.name, t.avatar)}

            <!-- 中央：名前・スニペット -->
            <div class="min-w-0 flex-1">
              <div class="flex items-center justify-between">
                <span class="font-medium truncate">${t.name}</span>
                <span class="ml-3 shrink-0 text-xs text-black/50">${t.lastAt}</span>
              </div>
              <p class="mt-0.5 text-sm text-black/70 truncate">${t.snippet || ''}</p>
            </div>

            <!-- 右：未読バッジ（未読のみ表示/青） -->
            ${unreadBadge(t.unread)}
          </a>
        `;
        list.appendChild(li);
      });
    }

    render();

    // =====（任意）未読を既読にするデモ =====
    // 例: 3秒後に2番目のスレッドを既読に
    // setTimeout(() => { threads[1].unread = 0; render(); }, 3000);
  </script>
</body>
</html>